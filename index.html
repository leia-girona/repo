<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <title id="doc-title">Repositorio de recursos educativos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Configura Tailwind CSS para usar el modo oscuro basado en clases
        tailwind.config = {
          darkMode: 'class'
        }
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="estilos.css">
</head>
<body class="text-gray-800 bg-gray-50 dark:bg-gray-900 dark:text-gray-200">

    <div class="container mx-auto p-4 md:p-8">
    <header class="relative text-center mb-4 p-6 rounded-xl bg-gradient-to-b from-blue-50 to-gray-50 dark:from-slate-900 dark:to-gray-900">
        
        <div class="absolute top-6 right-6 flex items-center space-x-2">
            <!-- Language selector -->
            <label for="lang-select" class="sr-only">Idioma</label>
            <select id="lang-select" class="text-sm rounded-md border border-gray-300 bg-white/70 backdrop-blur px-2 py-1 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-200">
                <option value="es">Español</option>
                <option value="ca">Català</option>
                <option value="gl">Galego</option>
                <option value="eu">Euskara</option>
                <option value="en">English</option>
            </select>
            <button id="theme-light-btn" title="Modo Claro" class="theme-btn">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </button>
            <button id="theme-dark-btn" title="Modo Oscuro" class="theme-btn">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </button>
            <button id="theme-system-btn" title="Preferencias del sistema" class="theme-btn">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
            </button>
        </div>

        <div class="flex justify-center items-center gap-4">
            <img src="logo.png" alt="Logo del Repositorio" class="h-16 md:h-20">
            <h1 id="app-title" class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white">Repositorio de aplicaciones educativas</h1>
        </div>
        <p id="app-subtitle" class="mt-4 text-lg text-gray-600 dark:text-gray-300">
        Una colección de aplicaciones y recursos educativos creados por la comunidad LEIA Girona
        </p>
    </header>

        <div class="flex flex-col md:flex-row gap-4 items-center mb-4">
            <div class="relative w-full md:flex-grow">
                <label id="search-label" for="search-input" class="sr-only">Búsqueda libre</label>
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                     <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" /></svg>
                </div>
                <input type="text" id="search-input" placeholder="Buscar por todos los campos..." class="w-full p-2 pl-10 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                <button id="clear-search-btn" title="Limpiar búsqueda" class="absolute inset-y-0 right-0 pr-3 flex items-center hidden text-gray-500 hover:text-gray-700 focus:outline-none dark:text-gray-400 dark:hover:text-gray-200">
                    <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>

            <div class="flex-shrink-0 flex gap-2 w-full md:w-auto">
                <button id="toggle-favorites-btn" title="Mostrar solo favoritos" class="action-btn flex flex-grow justify-center items-center gap-2 bg-white text-gray-700 font-semibold py-2 px-4 rounded-lg hover:bg-gray-100 shadow-sm border border-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                    <span id="btn-favorites-text" class="hidden sm:inline">Favoritos</span>
                </button>
                <button id="toggle-filters-btn" title="Mostrar/ocultar filtros" class="action-btn flex flex-grow justify-center items-center gap-2 bg-white text-gray-700 font-semibold py-2 px-4 rounded-lg hover:bg-gray-100 shadow-sm border border-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line></svg>
                    <span id="btn-filters-text">Filtros</span>
                </button>
                <button id="help-btn" title="Ayuda" aria-label="Ayuda" class="flex-shrink-0 flex justify-center items-center bg-gray-500 text-white font-semibold p-2.5 rounded-lg hover:bg-gray-600 transition shadow-sm dark:bg-gray-600 dark:hover:bg-gray-500">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                    <span id="help-btn-label" class="sr-only">Ayuda</span>
                </button>
            </div>

        </div>

        <div id="filter-panel" class="bg-white p-4 sm:p-6 rounded-xl shadow-sm mb-8 sticky top-4 z-10 border border-gray-200 hidden dark:bg-gray-800 dark:border-gray-700">
            <div id="filters-container" class="space-y-4"></div>
            <div class="mt-6 border-t pt-4 flex justify-end gap-3 flex-wrap dark:border-gray-700">
                 <button id="close-filters-btn" class="w-full sm:w-auto px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition dark:bg-gray-500 dark:hover:bg-gray-400">Aplicar filtros</button>
                 <button id="reset-filters-btn" class="w-full sm:w-auto px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition dark:bg-gray-500 dark:hover:bg-gray-400">Limpiar Filtros</button>
            </div>
        </div>

        <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 min-h-[2rem] gap-4">
            <div id="results-counter" class="text-sm text-gray-600 font-medium order-2 sm:order-1 dark:text-gray-400"></div>

            <div class="flex items-center gap-4 order-1 sm:order-2">
                 
                 <div id="actions-bar" class="hidden flex items-center gap-4">
                    <button id="share-url-btn" class="hidden text-sm text-blue-600 hover:text-blue-800 font-semibold flex items-center gap-1 dark:text-blue-400 dark:hover:text-blue-300">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" y1="2" x2="12" y2="15"></line></svg>
                        <span id="share-filters-text">Compartir Filtros</span>
                    </button>
                    <button id="clear-favorites-btn" class="hidden text-sm text-red-600 hover:text-red-800 font-semibold flex items-center gap-1 dark:text-red-500 dark:hover:text-red-400">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18m-2 0v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                        <span id="clear-favorites-text">Limpiar Favoritos</span>
                    </button>
                    <button id="clear-all-btn" class="hidden text-sm text-blue-600 hover:text-blue-800 font-semibold flex items-center gap-1 dark:text-blue-400 dark:hover:text-blue-300">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"></path><line x1="18" y1="9" x2="12" y2="15"></line><line x1="12" y1="9" x2="18" y2="15"></line></svg>
                        <span id="clear-all-text">Limpiar todo</span>
                    </button>
                </div>
                <div class="flex items-center gap-2">
                    <label id="items-per-page-label" for="items-per-page-selector" class="text-sm font-medium text-gray-600 dark:text-gray-400">Mostrar:</label>
                    <select id="items-per-page-selector" class="text-sm rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300">
                        <option value="10">10</option>
                        <option value="25" selected>25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                        <option id="items-per-page-all" value="all">Todas</option>
                    </select>
                </div>
            </div>
        </div>
        <div id="custom-view-message" class="hidden text-center p-4 mb-4 bg-blue-100 text-blue-800 rounded-lg shadow dark:bg-blue-900/50 dark:text-blue-300"></div>
        <div id="active-filters-display" class="flex flex-wrap gap-2 mb-4"></div>

        <div id="loading-message" class="flex flex-col items-center justify-center text-center py-20">
            <svg class="animate-spin h-10 w-10 text-blue-600 dark:text-blue-400 mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
            <p id="loading-text" class="text-lg text-gray-600 font-semibold dark:text-gray-300">Cargando aplicaciones...</p>
        </div>
        <div id="error-message" class="hidden text-center py-10 bg-red-100 text-red-700 rounded-lg dark:bg-red-900/50 dark:text-red-400"><p id="error-text" class="text-lg">No se pudieron cargar los datos.</p></div>
        <div id="no-results-message" class="hidden text-center py-10"><p id="no-results-text" class="text-lg text-gray-500 dark:text-gray-400">No se encontraron aplicaciones.</p></div>
        <div id="no-favorites-message" class="hidden text-center py-10"><p id="no-favorites-text" class="text-lg text-gray-500 dark:text-gray-400">No tienes aplicaciones favoritas.<br><span class="text-sm">Haz clic en el corazón de una aplicación para añadirla.</span></p></div>
        
        <div id="favorites-tabs-container" class="mb-6 hidden"></div>

        <div id="apps-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>

        <div id="pagination-container" class="flex justify-center items-center gap-4 mt-8"></div>
    </div>

    <div id="category-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full dark:bg-gray-800">
            <div class="p-5 border-b dark:border-gray-700">
                <h3 id="category-modal-title" class="text-xl font-bold text-gray-800 dark:text-gray-100">Gestionar Favorito</h3>
            </div>
            <div class="p-5">
                <div class="mb-4">
                    <label id="label-category-select" for="category-select" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Elige una categoría</label>
                    <select id="category-select" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200"></select>
                </div>
                <div class="mb-4">
                    <label id="label-new-category" for="new-category-input" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">O crea una nueva</label>
                    <input type="text" id="new-category-input" placeholder="Ej: Matemáticas, Biología..." class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-200">
                </div>
                <div id="category-modal-error" class="text-red-600 text-sm mb-4 hidden dark:text-red-400"></div>
            </div>
            <div class="px-5 py-4 bg-gray-50 rounded-b-lg flex justify-between items-center dark:bg-gray-800/50">
                <button id="remove-favorite-btn" class="text-sm text-red-600 hover:text-red-800 font-semibold dark:text-red-500 dark:hover:text-red-400">Quitar de Favoritos</button>
                <div>
                    <button id="cancel-category-btn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition dark:bg-gray-600 dark:text-gray-200 dark:hover:text-gray-100 dark:hover:bg-gray-500">Cancelar</button>
                    <button id="save-category-btn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <div id="delete-category-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl max-w-sm w-full dark:bg-gray-800">
            <div class="p-5 text-center">
                <svg class="w-16 h-16 text-red-500 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                <h3 id="delete-category-title" class="text-xl font-bold text-gray-800 mb-2 dark:text-gray-100">¿Eliminar categoría?</h3>
                <p id="delete-category-confirm-text" class="text-gray-600 mb-6 dark:text-gray-300"></p>
            </div>
            <div class="px-5 py-4 bg-gray-50 rounded-b-lg flex justify-end items-center gap-3 dark:bg-gray-800/50">
                <button id="cancel-delete-category-btn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-500">Cancelar</button>
                <button id="confirm-delete-category-btn" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition">Sí, eliminar</button>
            </div>
        </div>
    </div>


    <footer class="text-center pt-8 pb-4 mt-12 border-t border-gray-200 text-sm text-gray-500 dark:border-gray-800 dark:text-gray-400">
        <p>Basado en una iniciativa del grupo <a href="https://t.me/vceduca" target="_blank" class="text-blue-600 hover:underline font-semibold dark:text-blue-400 dark:hover:text-blue-300">Vibe Coding Educativo</a>. Versión 1.7.0</p>
        <p class="mt-4">
            <a href="https://github.com/Vibe-Coding-Educativo/app_edu/" target="_blank" class="text-gray-600 hover:text-blue-600 font-semibold inline-flex items-center dark:text-gray-400 dark:hover:text-blue-400">
                <svg class="h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
                GitHub del proyecto
            </a>
        </p>
         <div class="mt-4 space-y-2">
            <p>
                <span class="text-gray-600 dark:text-gray-400">Contenidos:</span>
                <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.es" target="_blank" class="hover:underline ml-2 font-semibold text-blue-600 hover:text-blue-800 transition-colors dark:text-blue-400 dark:hover:text-blue-300">
                  Creative Commons BY-SA 4.0
                </a>
            </p>
            <p>
                <span class="text-gray-600 dark:text-gray-400">Código fuente:</span>
                <a href="LICENSE.txt" target="_blank" class="hover:underline ml-2 font-semibold text-blue-600 hover:text-blue-800 transition-colors dark:text-blue-400 dark:hover:text-blue-300">
                  GNU AGPL v3
                </a>
            </p>
        </div>
    </footer>

    <div id="help-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full h-[85vh] flex flex-col dark:bg-gray-800">
            <div class="flex-shrink-0 p-3 border-b flex justify-end items-center relative dark:border-gray-700">
                 <h3 id="help-title" class="text-xl font-bold text-gray-800 dark:text-gray-100 absolute left-1/2 -translate-x-1/2">Ayuda</h3>
                 <button id="close-help-btn" class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white text-3xl font-bold p-1 leading-none">&times;</button>
            </div>
            <div class="overflow-auto flex-grow">
                <iframe id="help-frame" src="about:blank" class="w-full h-full border-0"></iframe>
            </div>
        </div>
    </div>

    <div id="copy-confirm-msg" class="fixed bottom-5 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-sm py-2 px-4 rounded-full opacity-0 -translate-y-5 pointer-events-none dark:bg-gray-200 dark:text-gray-800">¡URL copiada al portapapeles!</div>

    <script src="script.js"></script>
    
    <div id="stats-modal" class="modal-overlay">
        <div class="modal-content">
            <button id="modal-close-btn" class="modal-close-btn">&times;</button>
            <iframe id="modal-iframe" src="about:blank" frameborder="0" title="Panel de Estadísticas"></iframe>
        </div>
    </div>

</body>
</html>
